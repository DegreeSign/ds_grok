/*! For license information please see degreesign.min.js.LICENSE.txt */
!function(e,o){"object"==typeof exports&&"object"==typeof module?module.exports=o():"function"==typeof define&&define.amd?define([],o):"object"==typeof exports?exports.dsGrok=o():e.dsGrok=o()}(this,()=>(()=>{"use strict";var e={109(e,o){Object.defineProperty(o,"__esModule",{value:!0}),o.grokSourcesStatement=o.GROK_IMAGE_PROMPT=o.GROK_SETUP=o.GROK_PRICING_TEXT=o.GROK_PRICING_IMAGES=o.GROK_PRICING_UNIT=o.GROK_BASE_URL=void 0;o.GROK_BASE_URL="https://api.x.ai/v1/",o.GROK_PRICING_UNIT=1e6,o.GROK_PRICING_TEXT={"grok-4-fast":{prompt:.2,cached:.05,completion:.5}},o.GROK_PRICING_IMAGES={"grok-imagine-image":{images:!0,prompt:.002,cached:.002,completion:.02}},o.grokSourcesStatement=e=>`The response should include all sources (link and page title heading) used in an array, such that it is \n{\n${e}\nsources:{link:string;pageTitle:string}[];\n}\nThe final response should be a valid stringified JSON object.`,o.GROK_SETUP='**Do not include in your response:**\n* a title\n* words count\n* information about yourself\n* unknowns such as $X number.\n* anything about or refer to this prompt\n* repeated sentence starters such as "A recent fact" or "General sentiment"\n* bullet points or any other formatting that violates JSON object\n\n**Do:**\n* edit ruthlessly to remove redundant phrases or ideas\n* respond with a valid JSON object\n',o.GROK_IMAGE_PROMPT="1. Create a 200 words prompt to generate an image based on this description:\n   DESCRIPTION_TEXT\n2. Produce a unique interesting image.\n3. Do not mention the number of words in the prompt.\n4. If the prompt results in any human figure in a revealing or explicit manner, revise the prompt without deviating from the required description to describe in detail a minimalist covering for each and every revealing part, without using explicit or intimate words."},173(e,o,t){Object.defineProperty(o,"__esModule",{value:!0}),o.grokAI=void 0;const r=t(109),n=e=>"The JSON response object should follow this TS interface. \ninterface ResponseType {\n"+e.map(e=>`${e.dataKeyName}: ${e.type}; // ${e.requiredData}\n`)+"};\n"+(0,r.grokSourcesStatement)("data:ResponseType;");o.grokAI=async({apiKey:e,responseType:o,prompt:t,model:s,format:a})=>{try{const i="image"==o&&"string"==typeof t,c="json"==o&&"string"!=typeof t;s=s||(i?Object.keys(r.GROK_PRICING_IMAGES)?.[0]:Object.keys(r.GROK_PRICING_TEXT)?.[0]);performance.now();const p=i?{model:s,prompt:t,response_format:a||"url",n:1}:c?{messages:[{role:"system",content:r.GROK_SETUP},{role:"user",content:n(t)}],model:s,stream:!1,temperature:"json"==o?.3:.7}:void 0,d=i?"images/generations":"chat/completions",u=e&&p?await fetch(`${r.GROK_BASE_URL}${d}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(p)}):void 0,l=await(u?.json()),m=l?.error?{code:l?.code,error:l?.error}:{data:l,error:void 0};let g,_=r.GROK_PRICING_IMAGES[s]?.completion||0,I="";if(null!=m?.error)return console.log("aiData error",m?.error),{success:!1,error:m?.error,costUSD:i?_.toFixed(4):"0"};if(!m?.data)return{success:!1,error:"",costUSD:i?_.toFixed(4):"0"};if("choices"in m?.data){_=(({usage:e,model:o})=>{try{const t=r.GROK_PRICING_TEXT[o]||r.GROK_PRICING_IMAGES[o],{prompt_tokens:n,prompt_tokens_details:{cached_tokens:s},total_tokens:a}=e||{prompt_tokens_details:{}},i=a-n,c=n*t.prompt;return(c+s*t.cached+i*t.completion)/r.GROK_PRICING_UNIT}catch(e){console.log("calculateGrokCost failed",e)}})({usage:m?.data?.usage,model:s})||0;const e=m?.data?.choices?.[0]?.message?.content;g=JSON.parse(e)}else if(i){const e=m?.data?.data?.[0];I=e?.url||e?.b64_json||""}else console.log("aiData issue",m);return{success:!0,costUSD:_.toFixed(4),seconds:(performance.now(),2).toFixed(2),...i?{type:"image",response:I}:{type:"json",response:g}}}catch(e){console.log("aiData failed",e)}return{success:!1,error:""}}},504(e,o,t){Object.defineProperty(o,"__esModule",{value:!0}),o.grokGenImage=void 0;const r=t(173),n=t(109);o.grokGenImage=async({apiKey:e,description:o})=>{try{const t=await(0,r.grokAI)({apiKey:e,responseType:"json",prompt:[{dataKeyName:"imagePrompt",type:"string",requiredData:n.GROK_IMAGE_PROMPT.replace("DESCRIPTION_TEXT",o)}]}),s=t?.success?t.response?.data?.imagePrompt:"",a=s?await(0,r.grokAI)({apiKey:e,responseType:"image",prompt:s}):void 0;return{prompt:s,url:a?.success&&"image"==a?.type?a?.response:void 0,costUSD:((+t?.costUSD||0)+ +(a?.costUSD||0)).toFixed(4)}}catch(e){console.log("grokGenImage failed",e)}return{}}}},o={};function t(r){var n=o[r];if(void 0!==n)return n.exports;var s=o[r]={exports:{}};return e[r](s,s.exports,t),s.exports}var r={};return(()=>{var e=r;Object.defineProperty(e,"__esModule",{value:!0}),e.grokGenImage=e.grokAI=void 0;const o=t(173);Object.defineProperty(e,"grokAI",{enumerable:!0,get:function(){return o.grokAI}});const n=t(504);Object.defineProperty(e,"grokGenImage",{enumerable:!0,get:function(){return n.grokGenImage}})})(),r})());